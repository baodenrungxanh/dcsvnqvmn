function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function extractThumbnail(e){for(var t="",a=!1,i=0;i<500;i++)if(a){if("'"==e[i]&&a)break;t+=e[i]}else"'"==e[i]&&(a=!0);return t}function getMetaContent(e){for(var t=document.getElementsByTagName("meta"),a=0;a<t.length;a++)if(t[a].getAttribute("property")===e)return t[a].getAttribute("content");return""}function listLoadMore(){allowLoadMore=!0,location.href.indexOf("/p/")>=0&&(allowLoadMore=!1),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-1500&&allowLoadMore&&requestLoadMore()})}displayNumber=8,loadTimes=0,postMaxPublished="",readDetaiTimes=0,isDetailAjaxPage=!1,currentState="index",$(document).on("click touch",".fb-share, .zalo-share",function(){getMetaContent("og:title"),getMetaContent("og:description"),getMetaContent("og:url");var e=$(this).attr("data-type"),t=$(this).attr("data-href");getMetaContent("og:title");switch(window.ga&&window.ga("send",{hitType:"event",eventCategory:"mobile_"+e,eventAction:"share",eventLabel:getMetaContent("og:title")}),e){case"facebook":if("undefined"!==window.FB)window.FB.ui({method:"share",href:t},function(e){})}}),blurDate=new Date;var loadTimes=0;function requestLoadMore(){if(allowLoadMore=!1,remainingHot>0)suggestHotArticle();else if(!(location.href.indexOf("/p/")>=0)){$("#loader").css("display","inline-block");var nextLink=$("#next-button").attr("href")+"&m=1";$.get(nextLink,function(response){var responseDOM=$(response);$.each(responseDOM.find("#post-list article"),function(e,t){var a=t.getAttribute("id").replace("id-","");displayedHotIdList.indexOf(a)>=0&&t.remove()}),$("#post-list").append(responseDOM.find("#post-list").html()),nextPage=responseDOM.find("#next-button").attr("href"),$("#next-button").attr("href",nextPage),$("#loader").css("display","none"),allowLoadMore=!0,$("video:not([parsed='true'])").each(function(){this.onloadedmetadata=function(e){assignVideoHandler(this)}}),eval(responseDOM.find("#ids").html()),getArticleStatistics(),loadTimes++,ga("send","event","Timelines","Load more",loadTimes)})}}function assignVideoHandler(e){$(e).attr("parsed",!0),$(e).attr("loop",!0),$(e).attr("playsinline","playsinline");var t=$(e).height();$(e).onScreen({tolerance:t/2,toggleClass:!1,doIn:function(){},doOut:function(){this.pause()}})}function toggleSearchBar(){var e=document.getElementById("search-bar");"none"===e.style.display||""==e.style.display?(e.style.display="block",document.getElementById("search-box").focus()):e.style.display="none"}function closeShareMenu(){previousState="",$("#share-action-menu").removeClass("visible")}function openShareMenu(e){previousState="share-dialog",history.pushState({event:"share-dialog",url:e},null,"#share"),$("#share-action-menu").addClass("visible"),$("#facebook-share-anchor").attr("href",e),$("#direct-link-anchor").attr("href",e)}function openCommentDialog(e,t){$("#close-popup").show(),previousState="view-comment",history.pushState({event:"view-comment",url:e},null,e+"#comment"),console.log(e),"undefined"==typeof commentDialog&&(commentDialog=$("<div class='modal comments-dialog' tabindex='-1' role='dialog'> <div class='modal-dialog' role='document'> <div class='modal-content'> <div class='modal-header'>  <a href='javascript:history.go(-1)' class='back-button pull-right'><i class='spr-close'></i></a> </div> <div class='modal-body'> <p>One fine body&hellip;</p> </div> </div> </div> </div>"),$("body").append(commentDialog)),$(commentDialog).find("div[class='modal-body']").html("<div id='ajax-fb-comment' ><div class='fb-comments' data-order-by='social' data-href='"+e+"' data-numposts='7'></div></div>"),commentDialog.modal("show"),FB.XFBML.parse(document.getElementById("ajax-fb-comment")),$("video[playing='true']").length>0&&$("video[playing='true']")[0].pause(),$.get("/feeds/posts/default/"+t+"?alt=json-in-script&callback=displayBuildinComment")}function displayBuildinComment(e){var t=e.entry.id.$t;t=t.split("-",t.lastIndexOf("-")+1)[2];var a=e.entry.content.$t.split("comments = ");if(a.length>=2){var i=a[1];i=i.replace("<\/script>",""),i=JSON.parse(i);for(var o="",n=0;n<i.length;n++){var s=i[n].avatar.split("/")[3];o+="<div class='media'><div class='mr-2'><img src='"+i[n].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+s+"' class='name' target='_blank'>"+i[n].name+"</a><div class='message'>"+i[n].message+"</div></div></div>"}o="<div class='top-comments'>"+o+"</div>",$("#ajax-fb-comment").append(o)}}function getArticleStatistics(){if("undefined"!=typeof ids){var currentIds=ids;if(void 0!==currentIds){for(var keyIndex=[],queryGraph="https://graph.facebook.com/?ids=",i=0;i<currentIds.length;i++){var postUrl=$("#id-"+currentIds[i]+" a")[0].href;queryGraph+=postUrl+",",keyIndex.push(postUrl)}queryGraph=queryGraph.substring(0,queryGraph.length-1),$.ajax({url:queryGraph,type:"GET",success:function(data){for(var i=0;i<=keyIndex.length-1;i++){var record=data[keyIndex[i]];if(void 0!==record.share){if(null!=document.getElementById("total-share-"+currentIds[i])){var likeContent=0==record.share.share_count?"":record.share.share_count+" Chia sẽ";""!=likeContent&&($("#s-c-"+currentIds[i]).show(),document.getElementById("total-share-"+currentIds[i]).innerHTML="<a href='"+keyIndex[i]+"'>"+likeContent+"</a>",$("#total-share-"+currentIds[i]).addClass("has-share"))}if(null!=document.getElementById("total-comments-"+currentIds[i])&&record.share.comment_count>0){if($("#total-comments-"+currentIds[i]).addClass("has-comment"),eval("typeof article"+currentIds[i]+" != 'undefined'")&&eval("article"+currentIds[i]+".totalComments")>0){$("#total-comments-"+currentIds[i]).addClass("has-comment");var totalComments=record.share.comment_count+eval("article"+currentIds[i]+".totalComments");document.getElementById("total-comments-"+currentIds[i]).innerHTML=totalComments+" Bình luận"}}else eval("typeof article"+currentIds[i]+" != 'undefined'")&&eval("article"+currentIds[i]+".totalComments")>0&&($("#total-comments-"+currentIds[i]).addClass("has-comment"),document.getElementById("total-comments-"+currentIds[i]).innerHTML=eval("article"+currentIds[i]+".totalComments")+" Bình luận")}}}})}}}function suggestHotArticle(){$("#loader").css("display","inline-block");var hasHotArticle=!1,seenHotIds=null;if(void 0===window.localStorage.seenHotIds?(seenHotIds=[],window.localStorage.setItem("seenHotIds","")):seenHotIds=window.localStorage.seenHotIds.split(","),$.each($("article[data-hot='true']"),function(e,t){seenHotIds.indexOf(t.getAttribute("id"))<0&&seenHotIds.push(t.getAttribute("id").replace("id-","")),t.removeAttribute("data-hot")}),window.localStorage.setItem("seenHotIds",seenHotIds),location.href.indexOf("/search/")<0){if(location.href.indexOf(".html")>=0&&location.href.indexOf("/p/")>=0)return;var pendingIdList=hotIdList.filter(function(e){return-1==seenHotIds.indexOf(e)}),suggestIdList=[];if(suggestIdList=pendingIdList.length>=3?pendingIdList.slice(-3):pendingIdList,remainingHot=pendingIdList.length-suggestIdList.length,suggestIdList.length>0){hasHotArticle=!0;for(var searchQuery="",i=0;i<suggestIdList.length;i++)searchQuery+="label:"+suggestIdList[i]+"|",displayedHotIdList.push(suggestIdList[i]);seenHotIds=seenHotIds.concat(suggestIdList);var maxLength=20;seenHotIds.length>maxLength&&(seenHotIds=seenHotIds.slice(0-maxLength)),window.localStorage.setItem("seenHotIds",seenHotIds),$.get("https://www.tatlon.com/search?q="+searchQuery,function(response){var responseDOM=$(response);$("#post-list").append(responseDOM.find("#post-list").html()),$("#loading-placeholder").remove(),allowLoadMore=!0,suggestHotArticleTimes++,$("video:not([parsed='true'])").each(function(){this.onloadedmetadata=function(e){assignVideoHandler(this)}}),eval(responseDOM.find("#ids").html()),getArticleStatistics(),$("#loader").css("display","none")})}else allowLoadMore=!0,$("#loader").css("display","none")}else allowLoadMore=!0,$("#loader").css("display","none");return hasHotArticle}function parseAlbum(id){var maxHeight=0,comparationSize=500,parentWith=$("#id-"+id+" .content").width();parentWith>comparationSize&&(parentWith=comparationSize);var structure=$("#id-"+id+" input[name='structure']").val();structure=null==structure?eval("album"+id):JSON.parse(structure);var hiddenIndex=-1,hiddenItemCount=0;$.each(structure,function(e,t){0==t.hasOwnProperty("container")&&(-1==hiddenIndex&&(hiddenIndex=e-1),hiddenItemCount++)}),html="";var highestHeight=0;$.each(structure,function(e,t){if(t.hasOwnProperty("container")){var a=parentWith*t.container.top/comparationSize,i=parentWith*t.container.left/comparationSize,o=parentWith*t.container.width/comparationSize,n=parentWith*t.container.height/comparationSize,s=parentWith*t.img.top/comparationSize,r=parentWith*t.img.left/comparationSize,l=parentWith*t.img.width/comparationSize,d=parentWith*t.img.height/comparationSize,c="";hiddenIndex==e&&(c="<div class='albummore1'><div class='albummore12'><div class='albummore123'>+"+hiddenItemCount+"</div></div></div>"),n>highestHeight&&(highestHeight=n),a>0&&(maxHeight=parentWith),html+="<a href='javascript:viewAlbum(\""+id+'", '+e+")' class='anchor-to-album-detail'><div class='album-item'  style='top: "+a+"px;left: "+i+"px;width: "+o+"px;height: "+n+"px;'><img  style='top: "+s+"px;left: "+r+"px;height: "+d+"px;'  width='"+l+"px' height='"+d+"px;' src=' "+t.src+" 'class=' "+t.imgClass+"'/>"+c+"</div></a>"}}),html+="</div>",0==maxHeight&&(maxHeight=highestHeight),document.getElementById("album"+id).innerHTML="<div class='album-container' style='height: "+maxHeight+"px;width: "+parentWith+"px;'>"+html}function viewAlbum(id,photoIndex){var postUrl=$("#id-"+id+" h3 a")[0].href;previousState="view-album",history.pushState({event:"view-comment",id:id},null,postUrl+"#view-album"),"undefined"==typeof albumDialog?(albumDialog=$("<div class='modal' tabindex='-1' role='dialog' id='album-modal'> <div class='modal-dialog album-dialog' role='document'> <div class='modal-content'> <div class='modal-header'> <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button> </div> <div class='modal-body'> <p>One fine body&hellip;</p> </div> </div> </div> </div>"),$("body").append(albumDialog),$(albumDialog).on("hidden.bs.modal",function(e){"false"==$(albumDialog).attr("goneHistory")&&history.go(-1)})):$(albumDialog).attr("goneHistory","false");var albumPosts=$("#id-"+id+" input[name='structure']").val();albumPosts=null==albumPosts?eval("album"+id):JSON.parse(albumPosts);var html="";$.each(albumPosts,function(e,t){html+="<div class='photo-item' id='album-photo-"+e+"'><img src='"+t.src+"'/></div>"}),html="<div><div>"+html+"</div><div><div><div id='dialog-fb-comment'><div class='fb-comments' data-order-by='social' data-href='"+postUrl+"' data-numposts='7' ></div></div><div id='dialog-comment'></div></div></div></div>",$.get("/feeds/posts/default/"+id+"?alt=json-in-script&callback=displayDialogComment"),$(albumDialog).find("div[class='modal-body']").html(html),FB.XFBML.parse(document.getElementById("dialog-fb-comment")),albumDialog.modal("show");var scrollPos=$("#album-photo-"+photoIndex).position().top;$("#album-modal").scrollTop(scrollPos),$("#close-popup").show()}function displayDialogComment(e){var t=e.entry.id.$t;t=t.split("-",t.lastIndexOf("-")+1)[2];var a=e.entry.content.$t.split("comments = ");if(a.length>=2){var i=a[1];i=i.replace("<\/script>",""),i=JSON.parse(i);for(var o="",n=0;n<i.length;n++){var s=i[n].avatar.split("/")[3],r="";n>30&&(r="style='display: none;'"),o+="<div class='media comment-"+t+"' "+r+"><div class='mr-2'><img src='"+i[n].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+s+"' class='name' target='_blank'>"+i[n].name+"</a><div class='message'>"+i[n].message+"</div></div></div>"}var l="";i.length>30&&(l="<div class='clearfix'></div><a id='show-more-comments-"+t+"' href=\"javascript:showMoreComments('"+t+"')\" class='more-comments'>Xem thêm "+(i.length-30)+" bình luận khác</a>"),o="<div class='top-comments'>"+o+l+"</div>",$("#dialog-comment").append(o)}}$(document).on("click",'a[id*="facebook-share-anchor"]',function(e){e.preventDefault();window.FB.ui({method:"share",href:$(this).attr("href")},function(e){alert("Cảm ơn bạn đã chia sẽ <3"),closeShareMenu()})}),displayedHotIdList=[],suggestHotArticleTimes=0,remainingHot=0,history.scrollRestoration="manual",$(document).ready(function(){location.hostname.indexOf("tlo")<0&&document.write(""),$("video").on("play",function(){var e=this.getAttribute("poster");$("video[poster!='"+e+"']").each(function(){$(this).get(0).pause()})}),$("video").each(function(){this.setAttribute("preload","metadata")}),$("video:not([parsed='true'])").each(function(){this.onloadedmetadata=function(e){assignVideoHandler(this)}}),$("#next-button").on("click",function(e){e.preventDefault(),requestLoadMore()}),$("#post-list article").length>0&&getArticleStatistics(),listLoadMore(),window.onfocus=function(){((new Date).getTime()-blurDate.getTime())/1e3>900&&$("body").append("<a class='new-notification' href='https://www.tatlon.com/?m=1'><svg aria-hidden='true' data-prefix='fas' data-icon='arrow-up' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 448 512' class='svg-inline--fa fa-arrow-up fa-w-14 fa-2x'><path fill='currentColor' d='M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z' class=''></path></svg><span> Bài mới</span></a>")},window.onblur=function(){blurDate=new Date},new Headroom(document.getElementById("sticker"),{offset:45,tolerance:5,classes:{initial:"animated",pinned:"slideDown",unpinned:""}}).init(),$(document).on("click",'a[class*="button-share"]',function(e){e.preventDefault(),openShareMenu(this.getAttribute("href"))}),$(document).on("click",'a[class*="comment-button"]',function(e){e.preventDefault(),openCommentDialog(this.getAttribute("href"),this.getAttribute("data-id"))}),$(document).on("click","a[class='post-link']",function(e){e.preventDefault()}),$(".shade").on("click",function(){closeShareMenu()});suggestHotArticle();if(location.href.indexOf(".html")>0&&"undefined"!=typeof comments){for(var e="",t=0;t<comments.length;t++){var a=comments[t].avatar.split("/")[3];e+="<div class='media'><div class='mr-2'><img src='"+comments[t].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+a+"' class='name' target='_blank'>"+comments[t].name+"</a><div class='message'>"+comments[t].message+"</div></div></div>"}e="<div class='top-comments'>"+e+"</div>",$("#current-comment").html(e)}location.href.indexOf("/search/")<0&&requestLoadMore()}),window.onpopstate=function(e){"share-dialog"==previousState?closeShareMenu():"view-comment"==previousState?(previousState="",$("video[playing='true']").length>0&&$("video[playing='true']")[0].play(),commentDialog.modal("hide"),$("#close-popup").hide()):null!=e.state&&"share-dialog"==e.state.event?openShareMenu(e.state.url):null!=e.state&&"view-comment"==e.state.event?openCommentDialog(e.state.url):"view-album"==previousState&&(previousState="",$(albumDialog).attr("goneHistory",!0),$(albumDialog).data("bs.modal").isShown&&albumDialog.modal("hide"),$("#close-popup").hide())};