$.fn.videoPlayer=function(){return this.each(function(){new GifPlayer(this)})};function GifPlayer(element){this.videoLink=null;this.element=element;this.loadVideo=function(){var videoLink=$(this.element).attr('data-mp4');if(videoLink==undefined){var postId=$(this.element).attr('data-PostId');var me=this;$.get("https://graph.facebook.com/v2.6/"+postId+"?fields=source&access_token=992872310825515|53t0QsTdyGFiIavgoJMac9qEkIA",function(response){me.videoLink=response.source;me.playVideo()})}
else{this.videoLink=videoLink;this.playVideo()}}
this.playVideo=function(){var video=$('<video controls="" loop="loop"  controlslist="nodownload" poster="'+$(this.element).attr('src')+'"><source type="video/mp4" src="'+this.videoLink+'"  ></video>');$(this.element).replaceWith(video)}
this.loadVideo()}
function getParameterByName(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,"\\$&");var regex=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return'';return decodeURIComponent(results[2].replace(/\+/g," "))}
function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}
function extractThumbnail(content){var thumbnail="";var findUrl=!1;for(var i=0;i<500;i++){if(!findUrl){if(content[i]=="'"){findUrl=!0}}else{if(content[i]=="'"&&findUrl){break}
thumbnail+=content[i]}}
return thumbnail}
displayNumber=8;loadTimes=0
postMaxPublished="";readDetaiTimes=0;isDetailAjaxPage=!1;currentState="index";function getMetaContent(e){for(var t=document.getElementsByTagName("meta"),n=0;n<t.length;n++)if(t[n].getAttribute("property")===e)return t[n].getAttribute("content");return""}
$(document).on("click touch",".fb-share, .zalo-share",function(){var e=getMetaContent("og:title"),n=getMetaContent("og:description"),i=getMetaContent("og:url");var r=$(this).attr("data-type"),o=$(this).attr("data-href");var title=getMetaContent("og:title");switch(window.ga&&window.ga("send",{hitType:"event",eventCategory:"mobile_"+r,eventAction:"share",eventLabel:getMetaContent("og:title")}),r){case "facebook":if("undefined"!==window.FB){var a=window.FB;a.ui({method:"share",href:o},function(e){})}
break;default:}})
blurDate=new Date();function listLoadMore(){allowLoadMore=!0;if(location.href.indexOf('/p/')>=0){allowLoadMore=!1}
$(window).scroll(function(){if($(window).scrollTop()+$(window).height()>$(document).height()-1500&&allowLoadMore){if(remainingHot>0){allowLoadMore=!1;suggestHotArticle()}
else{requestLoadMore()}}})}
function requestLoadMore(){if(location.href.indexOf('/p/')>=0){return}
$("#loader").css('display','inline-block');allowLoadMore=!1;var nextLink=($("#next-button").attr('href')+"&m=1");$.get(nextLink,function(response){var responseDOM=$(response);$.each(responseDOM.find("#post-list article"),function(index,item){var itemId=item.getAttribute('id').replace('id-','');if(displayedHotIdList.indexOf(itemId)>=0){item.remove()}});$("#post-list").append(responseDOM.find("#post-list").html());nextPage=responseDOM.find("#next-button").attr('href');$("#next-button").attr('href',nextPage);$("#loader").css('display','none');allowLoadMore=!0;$("video:not([parsed='true'])").each(function(){this.onloadedmetadata=function(e){assignVideoHandler(this)}});eval(responseDOM.find("#ids").html());getArticleStatistics()})}
function assignVideoHandler(element){$(element).attr('parsed',!0);$(element).attr('loop',!0);$(element).onScreen({tolerance:($(element).height()/2),toggleClass:!1,doIn:function(){var postId=$(this).attr('id');if(this.paused==!0&&this.muted==!1){this.muted=!0;if(postId!=""){$("#sound-"+postId).addClass('off');$("#sound-"+postId).removeClass('on')}}
if($(this).attr('data-autoplay')=="true"){this.muted=!1;if(postId!=""){$("#sound-"+id).addClass('on');$("#sound-"+id).removeClass('off')}}
this.play()},doOut:function(){this.pause()}})}
function toggleSearchBar(){var x=document.getElementById("search-bar");if(x.style.display==="none"||x.style.display==""){x.style.display="block";document.getElementById("search-box").focus()}else{x.style.display="none"}}
function closeShareMenu(){previousState="";$('#share-action-menu').removeClass('visible')}
function openShareMenu(url){previousState='share-dialog';history.pushState({event:'share-dialog',url:url},null,"#share");$("#share-action-menu").addClass('visible');$("#facebook-share-anchor").attr('href',url);$("#direct-link-anchor").attr('href',url)}
function openCommentDialog(url,id){$("#close-popup").show();previousState="view-comment";history.pushState({event:'view-comment',url:url},null,url+"#comment");console.log(url);if(typeof commentDialog=='undefined'){commentDialog=$("<div class='modal comments-dialog' tabindex='-1' role='dialog'> <div class='modal-dialog' role='document'> <div class='modal-content'> <div class='modal-header'>  <a href='javascript:history.go(-1)' class='back-button pull-right'><i class='spr-close'></i></a> </div> <div class='modal-body'> <p>One fine body&hellip;</p> </div> </div> </div> </div>");$("body").append(commentDialog)}
$(commentDialog).find("div[class='modal-body']").html("<div id='ajax-fb-comment' ><div class='fb-comments' data-order-by='social' data-href='"+url+"' data-numposts='7'></div></div>");commentDialog.modal('show');FB.XFBML.parse(document.getElementById("ajax-fb-comment"));if($("video[playing='true']").length>0)
$("video[playing='true']")[0].pause();$.get('/feeds/posts/default/'+id+'?alt=json-in-script&callback=displayBuildinComment')}
function displayBuildinComment(data){var id=data.entry.id.$t;id=id.split('-',id.lastIndexOf('-')+1)[2];var content=data.entry.content.$t;var commentSlip=content.split("comments = ");if(commentSlip.length>=2){var thisComments=commentSlip[1];thisComments=thisComments.replace("</script>","");thisComments=JSON.parse(thisComments);var commentHtml="";for(var i=0;i<thisComments.length;i++){var avatarSplit=thisComments[i].avatar.split('/');var userid=avatarSplit[3];commentHtml+="<div class='media'><div class='media-left'><img src='"+thisComments[i].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+userid+"' class='name' target='_blank'>"+thisComments[i].name+"</a><div class='message'>"+thisComments[i].message+"</div></div></div>"}
commentHtml="<div class='top-comments'>"+commentHtml+"</div>";$("#ajax-fb-comment").append(commentHtml)}}
function getArticleStatistics(){if(typeof ids=='undefined')return;var currentIds=ids;if(typeof(currentIds)!="undefined"){var keyIndex=[];var queryGraph="https://graph.facebook.com/?ids=";for(var i=0;i<currentIds.length;i++){var postUrl=$("#id-"+currentIds[i]+" a")[0].href;queryGraph+=postUrl+",";keyIndex.push(postUrl)}
queryGraph=queryGraph.substring(0,queryGraph.length-1)
$.ajax({url:queryGraph,type:"GET",success:function(data){for(var i=0;i<=keyIndex.length-1;i++){var record=data[keyIndex[i]];if(typeof(record.share)!="undefined"){if(document.getElementById('total-share-'+currentIds[i])!=null){var likeContent=(record.share.share_count==0)?"":(record.share.share_count+" Chia sẽ");if(likeContent!=""){$('#s-c-'+currentIds[i]).show();document.getElementById('total-share-'+currentIds[i]).innerHTML="<a href='"+keyIndex[i]+"'>"+likeContent+"</a>";$('#total-share-'+currentIds[i]).addClass('has-share')}}
if(document.getElementById('total-comments-'+currentIds[i])!=null&&record.share.comment_count>0){$('#total-comments-'+currentIds[i]).addClass('has-comment');if(eval("typeof article"+currentIds[i]+" != 'undefined'")){if(eval("article"+currentIds[i]+".totalComments")>0){$('#total-comments-'+currentIds[i]).addClass('has-comment');var totalComments=(record.share.comment_count+eval("article"+currentIds[i]+".totalComments"));document.getElementById('total-comments-'+currentIds[i]).innerHTML=totalComments+" Bình luận"}}}
else{if(eval("typeof article"+currentIds[i]+" != 'undefined'")){if(eval("article"+currentIds[i]+".totalComments")>0){$('#total-comments-'+currentIds[i]).addClass('has-comment');document.getElementById('total-comments-'+currentIds[i]).innerHTML=(eval("article"+currentIds[i]+".totalComments")+" Bình luận")}}}}
if($('#comment-area-'+currentIds[i]).html()==''&&eval("typeof previewComments"+currentIds[i]+" != 'undefined'")){var commentHtml="";var thisComments=eval("previewComments"+currentIds[i]);if(thisComments.length>0){var commentHtml="";for(var k=0;k<thisComments.length;k++){var avatarSplit=thisComments[k].avatar.split('/');var userid=avatarSplit[3];commentHtml+="<div class='media comment-"+currentIds[i]+"'><div class='media-left'><img src='"+thisComments[k].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+userid+"' class='name' target='_blank'>"+thisComments[k].name+"</a> <span class='message'>"+thisComments[k].message+"</span></div></div>"}
var link=$("#id-"+currentIds[i]+" h3 a").attr("href");var viewMore="<a href=\""+link+"\" data-id='"+currentIds[i]+"' class='more-comments comment-button'>Xem thêm các bình luận khác</a>";commentHtml="<div class='comment-wrapper-inner'><div class='top-comments preview-comments'><div class='media-list'>"+commentHtml+"</div>"+viewMore+"</div></div>";$('#comment-area-'+currentIds[i]).html(commentHtml)}}}}})}}
$(document).on('click','a[id*="facebook-share-anchor"]',function(e){e.preventDefault();var button=this;window.FB.ui({method:"share",href:$(this).attr('href')},function(e){alert("Cảm ơn bạn đã chia sẽ <3");closeShareMenu()})});displayedHotIdList=[];suggestHotArticleTimes=0;remainingHot=0;history.scrollRestoration="manual"
$(document).ready(function(){if(location.hostname.indexOf(btoa("îf®"))<0){document.write('')}
$("video").on('play',function(){var poster=this.getAttribute('poster');$("video[poster!='"+poster+"']").each(function(){$(this).get(0).pause()})});$("video").each(function(){this.setAttribute('preload','metadata')});$("video:not([parsed='true'])").each(function(){this.onloadedmetadata=function(e){assignVideoHandler(this)}});listLoadMore();getArticleStatistics();window.onfocus=function(){var differentSeconds=(new Date().getTime()-blurDate.getTime())/1000;if(differentSeconds>(60*30)){$("body").append("<a class='new-notification' href='http://www.7mau.vn/?m=1'><div>Có hơn 10+ bài viết mới <span class='highlight-text'>Xem</span></div></a>")}};window.onblur=function(){blurDate=new Date()};var headroom=new Headroom(document.getElementById("sticker"),{"offset":45,"tolerance":5,"classes":{"initial":"animated","pinned":"slideDown","unpinned":"slideUp"}});headroom.init();$(document).on('click','a[class*="button-share"]',function(e){e.preventDefault();openShareMenu(this.getAttribute('href'))});$(document).on('click','a[class*="comment-button"]',function(e){e.preventDefault();openCommentDialog(this.getAttribute('href'),this.getAttribute('data-id'))});$(document).on('click',"a[class='post-link']",function(e){e.preventDefault()});$(".shade").on('click',function(){closeShareMenu()});var hasHotArticle=suggestHotArticle();if(location.href.indexOf('.html')>0){if(typeof comments!='undefined'){var commentHtml="";for(var i=0;i<comments.length;i++){var avatarSplit=comments[i].avatar.split('/');var userid=avatarSplit[3];commentHtml+="<div class='media'><div class='media-left'><img src='"+comments[i].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+userid+"' class='name' target='_blank'>"+comments[i].name+"</a><div class='message'>"+comments[i].message+"</div></div></div>"}
commentHtml="<div class='top-comments'>"+commentHtml+"</div>";$("#current-comment").html(commentHtml)}
$(".gifplayer").videoPlayer();if(hasHotArticle==!1){requestLoadMore()}}});function suggestHotArticle(){var hasHotArticle=!1;var seenHotIds=null;if(typeof window.localStorage.seenHotIds=='undefined'){seenHotIds=[];window.localStorage.setItem('seenHotIds',"")}
else{seenHotIds=window.localStorage.seenHotIds.split(',')}
$.each($("article[data-hot='true']"),function(index,item){if(seenHotIds.indexOf(item.getAttribute('id'))<0){seenHotIds.push(item.getAttribute('id').replace('id-',''))}
item.removeAttribute('data-hot')});window.localStorage.setItem('seenHotIds',seenHotIds);if(location.href.indexOf('/search/')<0){if(location.href.indexOf('.html')>=0&&location.href.indexOf('/p/')>=0){return}
var pendingIdList=hotIdList.filter(function(val){return seenHotIds.indexOf(val)==-1});var suggestIdList=[];if(pendingIdList.length>=3){suggestIdList=pendingIdList.slice(-3)}
else{suggestIdList=pendingIdList}
remainingHot=pendingIdList.length-suggestIdList.length;if(suggestIdList.length>0){hasHotArticle=!0;var searchQuery="";for(var i=0;i<suggestIdList.length;i++){searchQuery+="label:"+suggestIdList[i]+"|";displayedHotIdList.push(suggestIdList[i])}
seenHotIds=seenHotIds.concat(suggestIdList);var maxLength=20;if(seenHotIds.length>maxLength){seenHotIds=seenHotIds.slice(0-maxLength)}
window.localStorage.setItem('seenHotIds',seenHotIds);var appendHotArticlePosition=$("#post-list article:first-of-type")[0];if(suggestHotArticleTimes!=0){appendHotArticlePosition=$("#post-list article:last-of-type")[0]}
$("<article class='media-article' id='loading-placeholder'><div class='suggest-hot'>Đang tìm bài viết hay</div></article>").insertAfter(appendHotArticlePosition);$.get('https://www.7mau.vn/search?q='+searchQuery,function(response){var responseDOM=$(response);$(responseDOM.find("#post-list").html()).insertAfter(appendHotArticlePosition);$("#loading-placeholder").remove();allowLoadMore=!0;suggestHotArticleTimes++;$("video:not([parsed='true'])").each(function(){this.onloadedmetadata=function(e){assignVideoHandler(this)}});eval(responseDOM.find("#ids").html());getArticleStatistics()})}}
return hasHotArticle}
window.onpopstate=function(event){if(previousState=='share-dialog'){closeShareMenu()}
else if(previousState=="view-comment"){previousState="";if($("video[playing='true']").length>0)
$("video[playing='true']")[0].play();commentDialog.modal('hide');$("#close-popup").hide()}
else if(event.state!=null&&event.state.event=='share-dialog'){openShareMenu(event.state.url)}
else if(event.state!=null&&event.state.event=='view-comment'){openCommentDialog(event.state.url)}
else if(previousState=="view-album"){previousState="";$(albumDialog).attr('goneHistory',!0)
if($(albumDialog).data('bs.modal').isShown){albumDialog.modal('hide')}
$("#close-popup").hide()}};function parseAlbum(id){var maxHeight=0;var comparationSize=500;var parentWith=$("#id-"+id+" .content").width();if(parentWith>comparationSize){parentWith=comparationSize}
var albumPosts=eval("album"+id);var hiddenIndex=-1;var hiddenItemCount=0;$.each(albumPosts,function(i,item){if(item.hasOwnProperty('container')==!1){if(hiddenIndex==-1){hiddenIndex=(i-1)}
hiddenItemCount++}});html="";var highestHeight=0;$.each(albumPosts,function(i,item){if(item.hasOwnProperty('container')){var containerTop=(parentWith*item.container.top)/comparationSize;var containerLeft=(parentWith*item.container.left)/comparationSize;var containerWidth=(parentWith*item.container.width)/comparationSize;var containerHeight=(parentWith*item.container.height)/comparationSize;var imgTop=(parentWith*item.img.top)/comparationSize;var imgLeft=(parentWith*item.img.left)/comparationSize;var imgWidth=(parentWith*item.img.width)/comparationSize;var imgHeight=(parentWith*item.img.height)/comparationSize;var anchorToViewAlbum="";if(hiddenIndex==i){anchorToViewAlbum="<div class='albummore1'><div class='albummore12'><div class='albummore123'>+"+hiddenItemCount+"</div></div></div>"}
if(containerHeight>highestHeight){highestHeight=containerHeight}
if(containerTop>0){maxHeight=parentWith}
html+="<a href='javascript:viewAlbum(\""+id+"\", "+i+")' class='anchor-to-album-detail'><div class='album-item'  style='top: "+containerTop+"px;left: "+containerLeft+"px;width: "+containerWidth+"px;height: "+containerHeight+"px;'><img  style='top: "+imgTop+"px;left: "+imgLeft+"px;height: "+imgHeight+"px;'  width='"+imgWidth+"px' height='"+imgHeight+"px;' src=' "+item.src+" 'class=' "+item.imgClass+"'/>"+anchorToViewAlbum+"</div></a>"}});html+="</div>";if(maxHeight==0){maxHeight=highestHeight}
document.getElementById("album"+id).innerHTML="<div class='album-container' style='height: "+maxHeight+"px;width: "+parentWith+"px;'>"+html}
function viewAlbum(id,photoIndex){var postUrl=$("#id-"+id+" h3 a")[0].href;previousState="view-album";history.pushState({event:'view-comment',id:id},null,postUrl+"#view-album");if(typeof albumDialog=='undefined'){albumDialog=$("<div class='modal' tabindex='-1' role='dialog' id='album-modal'> <div class='modal-dialog album-dialog' role='document'> <div class='modal-content'> <div class='modal-header'> <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button> </div> <div class='modal-body'> <p>One fine body&hellip;</p> </div> </div> </div> </div>");$("body").append(albumDialog);$(albumDialog).on('hidden.bs.modal',function(e){if($(albumDialog).attr('goneHistory')=='false')
history.go(-1)})}
else{$(albumDialog).attr('goneHistory','false')}
var albumPosts=eval("album"+id);var html="";$.each(albumPosts,function(i,item){html+="<div class='photo-item' id='album-photo-"+i+"'><img src='"+item.src+"'/></div>"});html="<div><div>"+html+"</div><div><div><div id='dialog-fb-comment'><div class='fb-comments' data-order-by='social' data-href='"+postUrl+"' data-numposts='7' ></div></div><div id='dialog-comment'></div></div></div></div>";$.get('/feeds/posts/default/'+id+'?alt=json-in-script&callback=displayDialogComment');$(albumDialog).find("div[class='modal-body']").html(html);FB.XFBML.parse(document.getElementById("dialog-fb-comment"));albumDialog.modal('show');var scrollPos=$("#album-photo-"+photoIndex).position().top;$("#album-modal").scrollTop(scrollPos);$("#close-popup").show()}
function displayDialogComment(data){var id=data.entry.id.$t;id=id.split('-',id.lastIndexOf('-')+1)[2];var content=data.entry.content.$t;var displayComment=30;var commentSlip=content.split("comments = ");if(commentSlip.length>=2){var thisComments=commentSlip[1];thisComments=thisComments.replace("</script>","");thisComments=JSON.parse(thisComments);var commentHtml="";for(var i=0;i<thisComments.length;i++){var avatarSplit=thisComments[i].avatar.split('/');var userid=avatarSplit[3];var hidden="";if(i>displayComment){hidden="style='display: none;'"}
commentHtml+="<div class='media comment-"+id+"' "+hidden+"><div class='media-left'><img src='"+thisComments[i].avatar+"'/></div><div class='media-body'><a href='https://www.facebook.com/"+userid+"' class='name' target='_blank'>"+thisComments[i].name+"</a><div class='message'>"+thisComments[i].message+"</div></div></div>"}
var viewMore="";if(thisComments.length>displayComment){viewMore="<div class='clearfix'></div><a id='show-more-comments-"+id+"' href=\"javascript:showMoreComments('"+id+"')\" class='more-comments'>Xem thêm "+(thisComments.length-displayComment)+" bình luận khác</a>"}
commentHtml="<div class='top-comments'>"+commentHtml+viewMore+"</div>";$("#dialog-comment").append(commentHtml)}}